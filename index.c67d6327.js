!function(){var e=document.querySelector(".game-field"),t={};function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function n(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}}function i(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||n(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e){document.querySelector(".game-score").textContent=e}function s(t){var r=Array.from(e.querySelectorAll(".field-row"));t.forEach(function(e,t){e.forEach(function(e,n){var i=r[t].cells[n];i.textContent="",i.classList.forEach(function(e){e.startsWith("field-cell--")&&i.classList.remove(e)}),0!==e&&(i.textContent=e,i.classList.add("field-cell--".concat(e)))})})}function o(e){var t=document.querySelector(".message-win"),r=document.querySelector(".message-lose"),n=document.querySelector(".message-start");switch(e){case"idle":n.classList.remove("hidden");break;case"lose":r.classList.remove("hidden");break;case"win":t.classList.remove("hidden")}}t=function(){var e;function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,t),this.size=4,this.score=0,this.status="idle",this.field=e||Array.from({length:4},function(){return[0,0,0,0]})}return e=[{key:"getState",value:function(){return this.field}},{key:"getScore",value:function(){return this.score}},{key:"getStatus",value:function(){return this.status}},{key:"moveLeft",value:function(){for(var e=0;e<4;e++){var t=this.field[e],r=this.mergeLeft(t);this.field[e]=r}}},{key:"mergeLeft",value:function(e){for(var t=e.filter(function(e){return 0!==e}),r=0;r<t.length-1;r++)t[r]===t[r+1]&&(t[r]=2*t[r],t[r+1]=0,this.score+=t[r],r++);for(t=t.filter(function(e){return 0!==e});t.length<4;)t.push(0);return t}},{key:"moveRight",value:function(){for(var e=0;e<4;e++){var t=i(this.field[e]);t.reverse();var r=this.mergeLeft(t);r.reverse(),this.field[e]=r}}},{key:"moveUp",value:function(){for(var e=0;e<4;e++){for(var t=[],r=0;r<4;r++)t.push(this.field[r][e]);for(var n=this.mergeLeft(t),i=0;i<4;i++)this.field[i][e]=n[i]}}},{key:"moveDown",value:function(){for(var e=0;e<4;e++){for(var t=[],r=0;r<4;r++)t.push(this.field[r][e]);t.reverse();var n=this.mergeLeft(t);n.reverse();for(var i=0;i<4;i++)this.field[i][e]=n[i]}}},{key:"start",value:function(){"idle"===this.status&&(this.status="playing",this.field=Array.from({length:4},function(){return[0,0,0,0]}),this.score=0,this.addRandomTile(),this.addRandomTile())}},{key:"restart",value:function(){this.status="idle",this.field=Array.from({length:4},function(){return[0,0,0,0]}),this.score=0}},{key:"addRandomTile",value:function(){for(var e=[],t=0;t<this.field.length;t++)for(var r=0;r<this.field[t].length;r++)0===this.field[t][r]&&e.push([t,r]);if(0!==e.length){var i,a=Math.floor(Math.random()*e.length),s=function(e){if(Array.isArray(e))return e}(i=e[a])||function(e,t){var r,n,i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var a=[],s=!0,o=!1;try{for(i=i.call(e);!(s=(r=i.next()).done)&&(a.push(r.value),2!==a.length);s=!0);}catch(e){o=!0,n=e}finally{try{s||null==i.return||i.return()}finally{if(o)throw n}}return a}}(i,2)||n(i,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),o=s[0],l=s[1];this.field[o][l]=.9>Math.random()?2:4}}},{key:"handleMove",value:function(e){var t=this.field.map(function(e){return i(e)});switch(e){case"left":this.moveLeft();break;case"right":this.moveRight();break;case"up":this.moveUp();break;case"down":this.moveDown()}for(var r=!1,n=0;n<4;n++){for(var a=0;a<4;a++)if(this.field[n][a]!==t[n][a]){r=!0;break}if(r)break}return r&&this.addRandomTile(),this.checkWin(),r}},{key:"checkWin",value:function(){for(var e=!0,t=0;t<this.field.length;t++){for(var r=0;r<this.field[t].length;r++){var n=this.field[t][r];if(2048===n){this.status="win";return}if(0===this.field[t][r])return;if(r<this.field[t].length-1&&n===this.field[t][r+1]||t<this.field.length-1&&n===this.field[t+1][r]){e=!1;break}}if(!e)break}e&&(this.status="lose")}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,e),t}(),document.addEventListener("DOMContentLoaded",function(){var e=new t,r=document.querySelector(".start"),n=document.querySelector(".message-win"),i=document.querySelector(".message-lose"),l=document.querySelector(".message.message-start");r.addEventListener("click",function(){switch(e.getStatus()){case"idle":r.classList.remove("start"),r.classList.add("restart"),r.textContent="Restart",l.classList.add("hidden"),n.classList.add("hidden"),i.classList.add("hidden"),e.start();break;case"playing":case"win":case"lose":r.classList.remove("restart"),r.classList.add("start"),r.textContent="Start",l.classList.remove("hidden"),n.classList.add("hidden"),i.classList.add("hidden"),e.restart()}s(e.getState()),a(e.getScore()),o(e.getStatus())}),document.addEventListener("keydown",function(t){if("playing"===e.getStatus()){var r=!1;switch(t.key){case"ArrowLeft":r=e.handleMove("left");break;case"ArrowRight":r=e.handleMove("right");break;case"ArrowUp":r=e.handleMove("up");break;case"ArrowDown":r=e.handleMove("down")}if(r){var n=e.getStatus(),i=e.getState(),l=e.getScore();s(i),a(l),o(n)}}})})}();
//# sourceMappingURL=index.c67d6327.js.map
